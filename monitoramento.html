<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Monitoramento de Férias - Visão Gerencial</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18.2.0/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.development.js"></script>
    
    <!-- Prop-Types -->
    <script crossorigin src="https://unpkg.com/prop-types@15.8.1/prop-types.js"></script>
    
    <!-- Recharts -->
    <script crossorigin src="https://unpkg.com/recharts@2.10.3/umd/Recharts.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; -webkit-tap-highlight-color: transparent; }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; height: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #f1f5f9; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo } = React;
        const { 
            BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip: RechartsTooltip, Legend, ResponsiveContainer, PieChart, Pie, Cell 
        } = Recharts;

        // --- ICONS ---
        const Icons = {
            Check: () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"><polyline points="20 6 9 17 4 12"/></svg>,
            Alert: () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>,
            Clock: () => <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
            Search: () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>,
            Activity: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>,
            Calendar: () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>,
            FileText: () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>,
            PlayCircle: () => <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><polygon points="10 8 16 12 10 16 10 8"/></svg>
        };

        // --- CONSTANTES GLOBAIS ---
        const CURRENT_DATE_STR = "05/01";

        const DATES = ["Todos", "20/12", "21/12", "22/12", "23/12", "24/12", "26/12", "27/12", "28/12", "29/12", "30/12", "31/12", "02/01", "03/01"];

        const parseDate = (dateStr) => {
            if (!dateStr) return 0;
            const [day, month] = dateStr.split('/').map(Number);
            let mon = month;
            if(month === 1) mon = 13; 
            return mon * 100 + day;
        };

        // --- MAPA DE DATAS ---
        const DATE_MAP = {
            "156878": "22/12", "157453": "22/12", "157454": "27/12", "157455": "27/12", "162112": "27/12",
            "174416": "20/12", "174521": "22/12", "174522": "23/12", "175283": "26/12", "176204": "27/12",
            "177393": "21/12", "177560": "20/12", "177561": "26/12", "177565": "22/12", "177566": "30/12",
            "177567": "30/12", "177568": "30/12", "177569": "30/12", "177570": "29/12", "177571": "29/12",
            "177572": "29/12", "177573": "29/12", "177574": "28/12", "177575": "28/12", "177576": "28/12",
            "177577": "28/12", "177578": "26/12", "177579": "27/12", "177580": "26/12", "177581": "26/12",
            "177582": "23/12", "177583": "23/12", "177584": "23/12", "177585": "23/12", "177586": "21/12",
            "177587": "23/12", "177588": "22/12", "177589": "22/12", "180885": "20/12", "180886": "23/12",
            "180887": "23/12", "180888": "22/12", "180890": "23/12", "180891": "22/12", "180893": "22/12",
            "180894": "26/12", "180895": "26/12", "180896": "29/12", "180898": "22/12", "180899": "22/12",
            "180900": "23/12", "180901": "20/12", "180903": "20/12", "180906": "23/12", "180907": "02/01",
            "180909": "29/12", "180910": "27/12", "181088": "22/12", "181089": "27/12", "181090": "23/12",
            "181331": "20/12", 
            "128648": "24/12", "130980": "20/12", "130988": "20/12", "157197": "22/12", "165138": "23/12",
            "165967": "22/12", "166652": "23/12", "167545": "24/12", "168299": "23/12", "177256": "23/12",
            "180775": "26/12", "180776": "23/12", "180777": "23/12", "180778": "20/12", "180779": "20/12",
            "180786": "26/12", "180790": "28/12", "180794": "28/12", "180795": "27/12", "180803": "26/12",
            "180804": "30/12", "180805": "26/12", "180806": "29/12", "180807": "21/12", "180937": "22/12",
            "180939": "21/12", "180942": "23/12", "180943": "23/12", "180944": "03/01", "181007": "26/12",
            "150815": "28/12", "180936": "23/12",
            "158371": "20/12", "176347": "22/12", "177073": "20/12", "180679": "27/12"
        };

        // --- STATUS REAL (ATUALIZADO) ---
        const STATUS_DB = {
            "156878": { status: "done", date: "24/12", who: "Sergio Aparecido" },
            "157453": { status: "done", date: "22/12", who: "Ricardo Aparecido" },
            "157454": { status: "done", date: "27/12", who: "Ricardo Aparecido" },
            "157455": { status: "done", date: "27/12", who: "Ricardo Aparecido" },
            "162112": { status: "done", date: "27/12", who: "Ricardo Aparecido" }, // Started
            "174416": { status: "done", date: "23/12", who: "Nilson Carlos" },
            "177393": { status: "done", date: "04/01", who: "Gabriel Feitosa" },
            "177560": { status: "done", date: "30/12", who: "Fernando Sebastião" },
            "177578": { status: "done", date: "26/12", who: "Sergio Aparecido" },
            "177579": { status: "done", date: "27/12", who: "Sergio Aparecido" },
            "177580": { status: "done", date: "27/12", who: "Marcio Rodrigues" },            
            "177583": { status: "done", date: "24/12", who: "Sergio Aparecido" },
            "177584": { status: "done", date: "24/12", who: "Marcio Rodrigues" },
            "177585": { status: "done", date: "23/12", who: "Sergio Aparecido" },
            "177586": { status: "done", date: "23/12", who: "Marcio Rodrigues" },
            "177587": { status: "done", date: "23/12", who: "Sergio Aparecido" },
            "177588": { status: "done", date: "22/12", who: "Sergio Aparecido" },
            "177589": { status: "done", date: "22/12", who: "Marcio Rodrigues" },
            "180891": { status: "partial", date: "22/12", who: "Jorge Augusto" },
            "180893": { status: "done", date: "24/12", who: "Luciano Jose" },
            "180898": { status: "done", date: "23/12", who: "Ricardo De Almeida" },
            "180900": { status: "done", date: "26/12", who: "Luciano Jose" },
            "180903": { status: "done", date: "24/12", who: "Anderson Luiz" },
            "181088": { status: "done", date: "30/12", who: "Elton De Jesus" },
            "181090": { status: "partial", date: "23/12", who: "Marcos Torini" },
            "157197": { status: "done", date: "22/12", who: "Marcos Bruno" },
            "165138": { status: "done", date: "23/12", who: "Renan Fatore" },
            "165967": { status: "done", date: "22/12", who: "Renan Fatore" },
            "166652": { status: "done", date: "23/12", who: "Renan Fatore" },
            "167545": { status: "partial", date: "24/12", who: "Renan Fatore" }, // Started
            "177256": { status: "done", date: "24/12", who: "Bruno Donizete" }, // Updated per log
            "180776": { status: "partial", date: "23/12", who: "Marcos Bruno" },
            "180807": { status: "done", date: "23/12", who: "Luan Carlos" },
            "180937": { status: "done", date: "23/12", who: "Deivid Jose" },
            "180939": { status: "done", date: "22/12", who: "Mauricio Freri" },
            "180943": { status: "done", date: "23/12", who: "Paulo Henrique" },
            "180936": { status: "done", date: "24/12", who: "Deivid Jose" },
            "181007": { status: "partial", date: "26/12", who: "Sergio Willian" }, // Updated per log
            "130980": { status: "partial", date: "27/12", who: "Renan Fatore" },
            "130988": { status: "partial", date: "27/12", who: "Marcio Pereira" },
            "158371": { status: "done", date: "27/12", who: "Cláudio Mazzari" },
            "177073": { status: "done", date: "27/12", who: "Edemilson Santos" },
            "180679": { status: "done", date: "30/12", who: "Vinicius Picon" }, // Updated per log
            "181067": { status: "done", date: "21/12", who: "Aliston Henrique" }, // Updated per log
            "181316": { status: "done", date: "21/12", who: "Aliston Henrique" }, // Updated per log
            "181085": { status: "done", date: "23/12", who: "Sergio Willian" }, // Updated per log
            "181448": { status: "done", date: "23/12", who: "Sergio Willian" }, // Updated per log
            "181449": { status: "done", date: "23/12", who: "Sergio Willian" }, // Updated per log
            "181450": { status: "done", date: "23/12", who: "Sergio Willian" }, // Updated per log
            "180526": { status: "done", date: "20/12", who: "Mauricio Freri" }, // Updated per log
            "181223": { status: "done", date: "20/12", who: "Mauricio Freri" }, // Updated per log
            "169062": { status: "done", date: "19/12", who: "Mauricio Freri" }, // Updated per log
            "181300": { status: "done", date: "20/12", who: "Vinicius Picon" }, // Updated per log
            "181297": { status: "done", date: "20/12", who: "Bruno Donizete" }, // Updated per log
            "181298": { status: "done", date: "20/12", who: "Bruno Donizete" }, // Updated per log
            "181299": { status: "done", date: "20/12", who: "Bruno Donizete" }, // Updated per log
            "181360": { status: "done", date: "22/12", who: "Bruno Donizete" }, // Updated per log
            "179144": { status: "done", date: "23/12", who: "Marcos Bruno" },
            "179105": { status: "done", date: "23/12", who: "Marcos Bruno" },
            "181340": { status: "done", date: "22/12", who: "Felipe Augusto" }, // Updated per log
            "181341": { status: "done", date: "22/12", who: "Felipe Augusto" }, // Updated per log
            "180716": { status: "done", date: "22/12", who: "Maykel Antonio" },
            "181358": { status: "done", date: "22/12", who: "Douglas Luis" }, // Updated per log
            "181249": { status: "done", date: "20/12", who: "Hercules Jose" }, // Updated per log
            "181445": { status: "done", date: "23/12", who: "Ricardo De Almeida" }, // Updated per log
            "181311": { status: "done", date: "20/12", who: "Felipe Augusto" }, // Updated per log
            "181310": { status: "done", date: "20/12", who: "Felipe Augusto" }, // Updated per log
            "181308": { status: "done", date: "20/12", who: "Felipe Augusto" }, // Updated per log
            "181342": { status: "done", date: "22/12", who: "Bruno Domingos" },
            "181345": { status: "done", date: "22/12", who: "Bruno Domingos" },
            "181346": { status: "done", date: "22/12", who: "Bruno Domingos" },
            "181347": { status: "done", date: "22/12", who: "Bruno Domingos" },
            "181296": { status: "done", date: "20/12", who: "Bruno Donizete" }, // Updated per log
            "180278": { status: "done", date: "20/12", who: "Rodrigo Boni" },
            "181248": { status: "done", date: "20/12", who: "Claudio Roberto" }, // Updated per log
            "181315": { status: "done", date: "21/12", who: "Vinicius Picon" }, // Updated per log
            "181359": { status: "done", date: "22/12", who: "Rodrigo Boni" },
            "181233": { status: "done", date: "20/12", who: "Marcio Ricardo" }, // Updated per log
            "181309": { status: "done", date: "20/12", who: "Marcio Ricardo" }, // Updated per log
            "181099": { status: "done", date: "20/12", who: "Marcio Ricardo" }, // Updated per log
            "181236": { status: "done", date: "20/12", who: "Sidinei Donizeti" },
            "181237": { status: "done", date: "20/12", who: "Sidinei Donizeti" },
            "181238": { status: "done", date: "20/12", who: "Sidinei Donizeti" },
            "180917": { status: "done", date: "20/12", who: "Sidinei Donizeti" },
            "181247": { status: "done", date: "20/12", who: "Jorge Augusto" },
            "181294": { status: "done", date: "20/12", who: "Jorge Augusto" },
            "181295": { status: "done", date: "20/12", who: "Jorge Augusto" },
            "180720": { status: "done", date: "20/12", who: "Marcos Torini" },
            "181334": { status: "done", date: "22/12", who: "Fernando Sebastiao" }, // Updated per log
            "181335": { status: "done", date: "22/12", who: "Fernando Sebastiao" }, // Updated per log
            "181372": { status: "done", date: "22/12", who: "Marcos Torini" },
            "181218": { status: "done", date: "19/12", who: "Gabriel Feitosa" }, // Updated per log
            "181219": { status: "done", date: "20/12", who: "Gabriel Feitosa" }, // Updated per log
            "181220": { status: "done", date: "20/12", who: "Gabriel Feitosa" }, // Updated per log
            "181221": { status: "done", date: "20/12", who: "Gabriel Feitosa" }, // Updated per log
            "180155": { status: "done", date: "20/12", who: "Gabriel Feitosa" }, // Updated per log
            "179538": { status: "done", date: "20/12", who: "Sergio Aparecido" },
            "180557": { status: "done", date: "20/12", who: "Gabriel Feitosa" }, // Updated per log
            "179613": { status: "done", date: "20/12", who: "Sergio Aparecido" },
            "179619": { status: "done", date: "21/12", who: "Sergio Aparecido" },
            "179930": { status: "done", date: "21/12", who: "Sergio Aparecido" },
            "180282": { status: "done", date: "21/12", who: "Vinicius Nepomuceno" },
            "180283": { status: "done", date: "21/12", who: "Vinicius Nepomuceno" },
            "181312": { status: "done", date: "21/12", who: "Priscila Maria" },
            "181314": { status: "done", date: "21/12", who: "Priscila Maria" },
            "181313": { status: "done", date: "21/12", who: "Priscila Maria" },
            "181111": { status: "done", date: "21/12", who: "Priscila Maria" },
            "181367": { status: "done", date: "22/12", who: "Edmilton Vicentini" }, // Updated per log
            "181447": { status: "done", date: "23/12", who: "Edmilton Vicentini" }, // Updated per log
            "166142": { status: "done", date: "21/12", who: "Gabriel Feitosa" },
            "181307": { status: "done", date: "21/12", who: "Gabriel Feitosa" },
            "181306": { status: "done", date: "21/12", who: "Gabriel Feitosa" },
            "181371": { status: "done", date: "23/12", who: "Luciano Jose" }, // Updated per log
            "181010": { status: "done", date: "22/12", who: "Flavio Fernando" },
            "175500": { status: "done", date: "23/12", who: "Flavio Fernando" },
            "181412": { status: "done", date: "23/12", who: "Tiago Felix" }, // Updated per log
            "181222": { status: "done", date: "20/12", who: "Luan Carlos" },
            "181305": { status: "done", date: "20/12", who: "Luan Carlos" },
            "181304": { status: "done", date: "21/12", who: "Luan Carlos" },
            "180171": { status: "done", date: "21/12", who: "Marcio Rodrigues" },
            "179553": { status: "done", date: "22/12", who: "Marcio Rodrigues" },
            "179552": { status: "done", date: "22/12", who: "Marcio Rodrigues" },
            "181454": { status: "done", date: "23/12", who: "Marcio Rodrigues" },
            "181336": { status: "done", date: "22/12", who: "Felipe Augusto" }, // Updated per log
            "181339": { status: "done", date: "22/12", who: "Felipe Augusto" }, // Updated per log
            "181349": { status: "done", date: "22/12", who: "Felipe Augusto" }, // Updated per log
            "181350": { status: "done", date: "22/12", who: "Felipe Augusto" }, // Updated per log
            "181352": { status: "done", date: "22/12", who: "Marcio Ricardo" },
            "181418": { status: "done", date: "23/12", who: "Felipe Augusto" }, // Updated per log
            "181389": { status: "done", date: "23/12", who: "Felipe Augusto" }, // Updated per log
            "181380": { status: "done", date: "22/12", who: "Fernando Sebastiao" },
            "179527": { status: "done", date: "21/12", who: "Luciano Jose" },
            "179927": { status: "done", date: "21/12", who: "Luciano Jose" },
            "180163": { status: "done", date: "22/12", who: "Luciano Jose" },
            "180164": { status: "done", date: "22/12", who: "Luciano Jose" },
            "180290": { status: "done", date: "22/12", who: "Luciano Jose" },
            "180300": { status: "done", date: "22/12", who: "Luciano Jose" },
            "181321": { status: "done", date: "22/12", who: "Luciano Jose" },
            "181364": { status: "done", date: "22/12", who: "Ricardo De Almeida" }, // Updated per log
            "181444": { status: "done", date: "23/12", who: "Ricardo De Almeida" }, // Updated per log
            "181456": { status: "done", date: "23/12", who: "Fabio Henrique" },
            "181438": { status: "done", date: "22/12", who: "Claudio Roberto" },
            "181437": { status: "done", date: "23/12", who: "Claudio Roberto" },
            "181455": { status: "done", date: "23/12", who: "Elton De Jesus" },
            "181343": { status: "done", date: "22/12", who: "Raonny Cruz" },
            "181344": { status: "done", date: "22/12", who: "Raonny Cruz" },
            "181348": { status: "done", date: "22/12", who: "Raonny Cruz" },
            "181351": { status: "done", date: "22/12", who: "Raonny Cruz" },
            "179002": { status: "done", date: "23/12", who: "Raonny Cruz" },
            "178979": { status: "done", date: "23/12", who: "Raonny Cruz" },
            "178995": { status: "done", date: "23/12", who: "Raonny Cruz" },
            "181415": { status: "done", date: "23/12", who: "Raonny Cruz" },
            "181416": { status: "done", date: "23/12", who: "Raonny Cruz" },
            "181417": { status: "done", date: "23/12", who: "Raonny Cruz" },
            "179068": { status: "done", date: "23/12", who: "Raonny Cruz" },
            "181228": { status: "done", date: "20/12", who: "Ricardo Aparecido" },
            "170243": { status: "done", date: "20/12", who: "Ricardo Aparecido" },
            "170244": { status: "done", date: "20/12", who: "Ricardo Aparecido" },
            "170246": { status: "done", date: "20/12", who: "Ricardo Aparecido" },
            "170231": { status: "done", date: "20/12", who: "Ricardo Aparecido" },
            "170363": { status: "done", date: "20/12", who: "Ricardo Aparecido" },
            "170373": { status: "done", date: "20/12", who: "Ricardo Aparecido" },
            "177656": { status: "done", date: "20/12", who: "Ricardo Aparecido" },
            "181366": { status: "done", date: "22/12", who: "Bruno Donizete" },
            "181441": { status: "done", date: "23/12", who: "Bruno Donizete" },
            "181241": { status: "done", date: "20/12", who: "Lourivaldo Adorno" }, // Updated per log
            "181244": { status: "done", date: "20/12", who: "Lourivaldo Adorno" }, // Updated per log
            "181377": { status: "done", date: "22/12", who: "Diego Aparecido" },
            "181378": { status: "done", date: "22/12", who: "Diego Aparecido" },
            "181375": { status: "done", date: "22/12", who: "Lourivaldo Adorno" }, // Updated per log
            "181376": { status: "done", date: "22/12", who: "Lourivaldo Adorno" }, // Updated per log
            "181382": { status: "done", date: "23/12", who: "Lourivaldo Adorno" }, // Updated per log
            "181383": { status: "done", date: "22/12", who: "Tiago Felix" }, // Updated per log
            "181387": { status: "done", date: "22/12", who: "Paolo Sergio" },
            "181319": { status: "done", date: "22/12", who: "Wagner Daun" }, // Updated per log
            "181365": { status: "done", date: "22/12", who: "Ricardo De Almeida" },
            "181103": { status: "done", date: "19/12", who: "Lucio Silveira" }, // Updated per log
            "181213": { status: "done", date: "20/12", who: "Fernando Santos" },
            "181301": { status: "done", date: "20/12", who: "Lucio Silveira" }, // Updated per log
            "181318": { status: "done", date: "21/12", who: "Lucio Silveira" }, // Updated per log
            "181370": { status: "done", date: "22/12", who: "Lucio Silveira" }, // Updated per log
            "181451": { status: "done", date: "23/12", who: "Fernando Santos" },
            "181452": { status: "done", date: "23/12", who: "Fernando Santos" },
            "181374": { status: "done", date: "22/12", who: "Douglas Luis" },
            "181381": { status: "done", date: "22/12", who: "Douglas Luis" },
            "181388": { status: "done", date: "23/12", who: "Douglas Luis" },
            "180150": { status: "done", date: "20/12", who: "Lucio Silveira" },
            "181302": { status: "done", date: "20/12", who: "Lucio Silveira" },
            "181303": { status: "done", date: "21/12", who: "Lucio Silveira" },
            "181446": { status: "done", date: "23/12", who: "Lucio Silveira" },
            "181386": { status: "done", date: "22/12", who: "Murilo Henrique" }, // Updated per log
            "181385": { status: "done", date: "22/12", who: "Murilo Henrique" }, // Updated per log
            "181384": { status: "done", date: "22/12", who: "Murilo Henrique" }, // Updated per log
            "181362": { status: "done", date: "22/12", who: "Vinicius Rodrigues" },
            "181363": { status: "done", date: "22/12", who: "Vinicius Rodrigues" },
            "181337": { status: "done", date: "22/12", who: "Felipe Augusto" },
            "179142": { status: "done", date: "23/12", who: "Felipe Augusto" },
            "178953": { status: "done", date: "23/12", who: "Felipe Augusto" },
            "176347": { status: "done", date: "28/12", who: "Fernando Moreira" },
            "180803": { status: "done", date: "26/12", who: "Luan Hipólito" },
            "180805": { status: "done", date: "27/12", who: "Edmilton Vicentini" },
            "150815": { status: "partial", date: "29/12", who: "Mauricio Freri" },
            "180901": { status: "done", date: "29/12", who: "Fábio Trindade" },           
            "177573": { status: "done", date: "30/12", who: "Sergio Aparecido" },            
            "177574": { status: "done", date: "30/12", who: "Sergio Aparecido" },
            "177575": { status: "done", date: "30/12", who: "Marcio Rodrigues" },
            "177576": { status: "done", date: "30/12", who: "Marcio Rodrigues" },
            "177577": { status: "done", date: "29/12", who: "Sergio Aparecido" },
            "177581": { status: "done", date: "27/12", who: "Marcio Rodrigues" },
            "180896": { status: "done", date: "29/12", who: "Fabio Trindade" },
            "180806": { status: "partial", date: "29/12", who: "Paulo Henrique" },
            "174522": { status: "done", date: "29/12", who: "Nilson Carlos" },
            "175283": { status: "done", date: "30/12", who: "Nilson Carlos" },
            "176204": { status: "done", date: "30/12", who: "Nilson Carlos" },
            "177570": { status: "done", date: "31/12", who: "Sergio Aparecido" },
            "177570": { status: "done", date: "31/12", who: "Sergio Aparecido" },
            "177571": { status: "done", date: "31/12", who: "Marcio Rodrigues" },
            "177572": { status: "done", date: "31/12", who: "Marcio Rodrigues" },
            "180886": { status: "done", date: "31/12", who: "Sidinei Donizete" },
            "181331": { status: "done", date: "30/12", who: "Marcos Torini" },
            "180804": { status: "done", date: "30/12", who: "Mauricio Freri" },
            "180942": { status: "done", date: "30/12", who: "Bruno Romão" },
            "180777": { status: "done", date: "30/12", who: "Paulo Henrique" },
            "177566": { status: "done", date: "03/01", who: "Marcio Rodrigues" },
            "177567": { status: "done", date: "03/01", who: "Marcio Rodrigues" },
            "177568": { status: "done", date: "03/01", who: "Sergio Aparecido" },
            "177569": { status: "done", date: "03/01", who: "Sergio Aparecido" },
            "177582": { status: "done", date: "03/01", who: "Sergio Aparecido" },
            "180907": { status: "done", date: "03/01", who: "Luciano José" },
            "180910": { status: "done", date: "03/01", who: "Anderson Sala" },
            "181089": { status: "done", date: "03/01", who: "Matheus Vinicius" },
            "181090": { status: "done", date: "30/12", who: "Marcos Torini" },
            "180786": { status: "done", date: "04/01", who: "Felipe Augusto" },
            "180790": { status: "done", date: "04/01", who: "Felipe Augusto" },
            "180788": { status: "partial", date: "04/01", who: "Bruno Romão" },
            "180779": { status: "partial", date: "02/01", who: "Raonny Cruz" }
        
        };

        const PLANNED_DATES_MAP = {
            "181088": ["22/12", "02/01"],
            "180903": ["20/12", "23/12"],
            "177560": ["20/12", "22/12"],
            "180906": ["23/12", "29/12"],
            "180910": ["27/12"],
            "181090": ["23/12", "02/01"],
            "180894": ["26/12", "02/01"],
            "174416": ["20/12", "30/12"],
            "158371": ["20/12", "26/12"],
            "177073": ["20/12", "31/12"],
            "180679": ["27/12", "30/12"],
            "176347": ["20/12", "22/12"],
            "180937": ["21/12", "29/12"],
            "180778": ["20/12", "21/12"],
            "180807": ["21/12", "23/12"],
            "165138": ["21/12", "23/12"],
            "130980": ["20/12", "30/12"],
        };

        const DATA_PROGRAMADA = [
            // LINHAS
            { om: "156878", asset: "452159-801 - L5", task: "Preventiva limpeza painéis", sector: "Linhas" },
            { om: "157453", asset: "510313/8 - TESTE FUNC. Nº 01 L4", task: "Preventiva Anual - Backlog.", sector: "Linhas" },
            { om: "157454", asset: "510425 - TESTE FUNC. Nº 02 L4", task: "Preventiva Anual - Backlog.", sector: "Linhas" },
            { om: "157455", asset: "510607 - TESTE FUNC. Nº 03 L4", task: "Preventiva Anual - Backlog.", sector: "Linhas" },
            { om: "162112", asset: "510424 - TESTE FUNC. Nº 04 L4", task: "Preventiva Anual - Backlog.", sector: "Linhas" },
            { om: "174416", asset: "803 / 804 - L3 / P1 / P2", task: "Troca do inversor", sector: "Linhas" },
            { om: "174521", asset: "803 / 804 - L3 / P1 / P2", task: "Troca do inversor", sector: "Linhas" },
            { om: "174522", asset: "803 / 804 - L3 / P1 / P2", task: "Troca do inversor", sector: "Linhas" },
            { om: "175283", asset: "803 / 804 - L3 / P1 / P2", task: "Troca do inversor", sector: "Linhas" },
            { om: "176204", asset: "803 / 804 - L3 / P1 / P2", task: "Troca do inversor", sector: "Linhas" },
            { om: "177393", asset: "EMBALADORA PROJPEACK L1", task: "Troca da esteira completa", sector: "Linhas" },
            { om: "177560", asset: "EMBALADORA PROJPACK L2", task: "Revisão geral e troca de Celeron", sector: "Linhas" },
            { om: "177561", asset: "EMBALADORA MÁQUINAPACK L3", task: "Verificação dos componentes", sector: "Linhas" },
            { om: "177565", asset: "510963/2 - ESTEIRA LIGAÇÃO L6", task: "Preventiva Anual - Backlog", sector: "Linhas" },
            { om: "177566", asset: "508378 - L1", task: "Preventiva limpeza painéis", sector: "Linhas" },
            { om: "177567", asset: "509153/1 - L2", task: "Preventiva limpeza painéis", sector: "Linhas" },
            { om: "177568", asset: "510169-1 - L3", task: "Preventiva limpeza painéis", sector: "Linhas" },
            { om: "177569", asset: "510169-2 - L3", task: "Preventiva limpeza painéis", sector: "Linhas" },
            { om: "177570", asset: "510169-3 - L3", task: "Preventiva limpeza painéis", sector: "Linhas" },
            { om: "177571", asset: "510169-4 - L3", task: "Preventiva limpeza painéis", sector: "Linhas" },
            { om: "177572", asset: "451878 - L3", task: "Preventiva limpeza painéis", sector: "Linhas" },
            { om: "177573", asset: "451878 - L3", task: "Preventiva limpeza painéis", sector: "Linhas" },
            { om: "177574", asset: "451878 - L3", task: "Preventiva limpeza painéis", sector: "Linhas" },
            { om: "177575", asset: "511270 - L3", task: "Preventiva limpeza painéis", sector: "Linhas" },
            { om: "177576", asset: "452159-801 - L5", task: "Preventiva limpeza painéis", sector: "Linhas" },
            { om: "177577", asset: "452159-802 - L5", task: "Preventiva limpeza painéis", sector: "Linhas" },
            { om: "177578", asset: "452159-803 - L5", task: "Preventiva limpeza painéis", sector: "Linhas" },
            { om: "512178", asset: "512178 - DPA", task: "Preventiva limpeza painéis", sector: "Linhas" },
            { om: "177580", asset: "451919-5 - L5", task: "Preventiva limpeza painéis", sector: "Linhas" },
            { om: "177581", asset: "451919-5 - L5", task: "Preventiva limpeza painéis", sector: "Linhas" },
            { om: "177582", asset: "452099 - L5", task: "Preventiva limpeza painéis", sector: "Linhas" },
            { om: "177583", asset: "452099 - L5", task: "Preventiva limpeza painéis", sector: "Linhas" },
            { om: "177584", asset: "512373 - L5", task: "Preventiva limpeza painéis", sector: "Linhas" },
            { om: "177585", asset: "511015 - L6", task: "Preventiva limpeza painéis", sector: "Linhas" },
            { om: "177586", asset: "510963/14 - L6", task: "Preventiva limpeza painéis", sector: "Linhas" },
            { om: "177587", asset: "510891 - L3", task: "Preventiva limpeza painéis", sector: "Linhas" },
            { om: "177588", asset: "511094 - L3", task: "Preventiva limpeza painéis", sector: "Linhas" },
            { om: "177589", asset: "508792-17 L4", task: "Preventiva limpeza painéis", sector: "Linhas" },
            { om: "180885", asset: "19664/3-Teste funcional L2", task: "Verificação e troca de barramentos", sector: "Linhas" },
            { om: "180886", asset: "Bomba de vácuo L2", task: "Realizar revisão nos sistema de vácuo", sector: "Linhas" },
            { om: "180887", asset: "19664/1-Teste motoca L2", task: "Revisão geral mecânica e elétrica", sector: "Linhas" },
            { om: "180888", asset: "510169.58-Elevador de topo L3", task: "Verificação dos trilhos", sector: "Linhas" },
            { om: "180890", asset: "510169/6-Manipulador de base L3", task: "Verificar garras e conjunto", sector: "Linhas" },
            { om: "180891", asset: "Gangorra", task: "Troca do componente e revisão", sector: "Linhas" },
            { om: "180893", asset: "Mezanino L3", task: "Troca de correntes e revisão", sector: "Linhas" },
            { om: "180894", asset: "Teste funcional (2 piores) L4", task: "Troca de correia", sector: "Linhas" },
            { om: "180895", asset: "Esteira talisca pós transf. L4", task: "Verificar desgaste corrente", sector: "Linhas" },
            { om: "180896", asset: "510313/5-Esteira de talisca 2 L4", task: "Revisão nos componentes", sector: "Linhas" },
            { om: "180898", asset: "Girador pré elevador L4", task: "Limpeza, verificação elétrica", sector: "Linhas" },
            { om: "180899", asset: "451485/03-Elevador final L4", task: "Limpeza, verificação dos componentes", sector: "Linhas" },
            { om: "180900", asset: "512655/02-Célula parafusamento", task: "Verificar componentes elevadores", sector: "Linhas" },
            { om: "180901", asset: "510313-Esteira de montagem mesa", task: "Verificação dos elevadores", sector: "Linhas" },
            { om: "180903", asset: "Esteira roletes estanqueidade", task: "Seccionar esteira", sector: "Linhas" },
            { om: "180906", asset: "451771-IFA", task: "Troca das borrachas dos empilhadores", sector: "Linhas" },
            { om: "180907", asset: "451771-Esteira entrada DOCA", task: "Tracionamento de roletes", sector: "Linhas" },
            { om: "180909", asset: "451771-Esteiras carregamento IFA", task: "Lubrificação e verificação", sector: "Linhas" },
            { om: "180910", asset: "451771-Systec velha", task: "Verificação componentes pentes", sector: "Linhas" },
            { om: "181088", asset: "PARAFUSAMENTO CAVID. L4", task: "Dry run, Validação drives", sector: "Linhas" },
            { om: "181089", asset: "célula de colagem de mesa", task: "criação de nova receita", sector: "Linhas" },
            { om: "181090", asset: "Teste funcional L2", task: "Revisão das caixinhas", sector: "Linhas" },
            { om: "181331", asset: "Manipulador X e Y - L2", task: "Retirada do inversor da esteira", sector: "Linhas" },
            
            // Metal
            { om: "128648", asset: "Linha 4 - Clinch", task: "Robo 33 - Troca de haste", sector: "Metal" },
            { om: "130980", asset: "Linha de Solda", task: "troca das mangueiras pneumáticas", sector: "Metal" },
            { om: "130988", asset: "Linha de Solda", task: "troca das mangueiras pneumáticas", sector: "Metal" },
            { om: "157197", asset: "linha de cavidades", task: "Estação 5050 - Amortecedor", sector: "Metal" },
            { om: "165138", asset: "LCL", task: "Preventiva mecânica", sector: "Metal" },
            { om: "165967", asset: "LCL", task: "Preventiva mecânica", sector: "Metal" },
            { om: "166652", asset: "LCL", task: "Preventiva mecânica", sector: "Metal" },
            { om: "167545", asset: "LCL", task: "Preventiva mecânica", sector: "Metal" },
            { om: "168299", asset: "LCL", task: "Preventiva mecânica", sector: "Metal" },
            { om: "177256", asset: "linha de cavidades", task: "Solda costura - mangueiras", sector: "Metal" },
            { om: "180775", asset: "linha de cavidades", task: "Chiller das prensas - Rolamentos", sector: "Metal" },
            { om: "180776", asset: "linha de cavidades", task: "Solda costura - Filtro retorno", sector: "Metal" },
            { om: "180777", asset: "Wrapper", task: "Investigar vazamento de óleo", sector: "Metal" },
            { om: "180778", asset: "Prensa 108", task: "Prev. endireitador de chapas", sector: "Metal" },
            { om: "180779", asset: "Prensa 117", task: "Prev. alimentador de chapas", sector: "Metal" },
            { om: "180786", asset: "Linha 4 - Clinch", task: "Unidade hidráulida robô 30 e 31", sector: "Metal" },
            { om: "180790", asset: "Linha 4 - Clinch", task: "Carro ejetor - Fuso", sector: "Metal" },
            { om: "180794", asset: "Linha 4 - Clinch", task: "Dobradeira - Torque motores", sector: "Metal" },
            { om: "180795", asset: "Linha 4 - Clinch", task: "Revisão sensores e cabeamentos", sector: "Metal" },
            { om: "180803", asset: "Painéis Esmaltação", task: "Limpeza e reaperto", sector: "Metal" },
            { om: "180804", asset: "Painéis Pintura", task: "Limpeza e reaperto", sector: "Metal" },
            { om: "180805", asset: "Painéis Cavidades", task: "Limpeza e reaperto", sector: "Metal" },
            { om: "180806", asset: "Painéis Funilaria", task: "Limpeza e reaperto", sector: "Metal" },
            { om: "180807", asset: "Painéis Press Shop", task: "Limpeza e reaperto", sector: "Metal" },
            { om: "180937", asset: "linha de cavidades", task: "Chillers - Prensas", sector: "Metal" },
            { om: "180939", asset: "linha de cavidades", task: "Chillers - Lasers", sector: "Metal" },
            { om: "180942", asset: "Pintura", task: "Queimadores (42)", sector: "Metal" },
            { om: "180943", asset: "Pintura", task: "Queimadores (43)", sector: "Metal" },
            { om: "180944", asset: "Pintura", task: "Migração controle CLP", sector: "Metal" },
            { om: "181007", asset: "Painéis da SFB", task: "Limpeza e reaperto", sector: "Metal" },
            { om: "150815", asset: "Prensa 123", task: "Prev. alimentador de chapas", sector: "Metal" },
            { om: "180936", asset: "linha de cavidades", task: "Chillers - Dielétrico", sector: "Metal" },
            // Plastico
            { om: "158371", asset: "503804-INJETORA 1100T", task: "Prev. Anual + Vazamentos", sector: "Plástico" },
            { om: "176347", asset: "509253-INJETORA 1850T 25", task: "Preventiva anual (Elétrica)", sector: "Plástico" },
            { om: "177073", asset: "509912-INJETORA 1850T 30", task: "Preventiva anual (Elétrica)", sector: "Plástico" },
            { om: "180679", asset: "miramondi", task: "Troca reparo cilindro", sector: "Plástico" }
        ];

        const UnifiedDashboard = () => {
            const [activeTab, setActiveTab] = useState("Visão Geral");
            const [searchTerm, setSearchTerm] = useState("");
            
            const CURRENT_DATE_VAL = parseDate(CURRENT_DATE_STR);

            const getClass = (planDate, statusInfo) => {
                if (statusInfo && statusInfo.status === 'partial') return 'Em execução';
                if (statusInfo && statusInfo.status === 'done') {
                    // if (statusInfo.date !== planDate) return 'Fechada F.P.';
                    return 'Fechada';
                }
                const planVal = parseDate(planDate);
                if (planVal > CURRENT_DATE_VAL) return 'Não executado';
                if (planVal <= CURRENT_DATE_VAL) return 'Quebra';
                return 'Desconhecido';
            };

            const unifiedData = useMemo(() => {
                let allTasks = [];
                DATA_PROGRAMADA.forEach(master => {
                    const omId = master.om;
                    // Get all planned dates for this OM or use a fallback
                    const dates = PLANNED_DATES_MAP[omId];
                    let startDateStr, endDateStr;
                    
                    if (dates && dates.length > 0) {
                        startDateStr = dates[0];
                        endDateStr = dates[dates.length - 1];
                    } else {
                        // Fallback
                        const singleDate = DATE_MAP[omId] || "27/12";
                        startDateStr = singleDate;
                        endDateStr = singleDate;
                    }
                    
                    const startVal = parseDate(startDateStr);
                    const endVal = parseDate(endDateStr);

                    // Find Execution Info
                    const executionLog = STATUS_DB[omId];
                    let status = "Não executado";
                    let execDateStr = "-";
                    let who = "-";
                    let execVal = 0;

                    if (executionLog) {
                        execDateStr = executionLog.date;
                        who = executionLog.who;
                        execVal = parseDate(execDateStr);
                        
                        // Check Status
                        if (executionLog.status === 'partial') {
                            status = "Em execução";
                        } else if (executionLog.status === 'done') {
                            // Check if inside range
                            if (execVal >= startVal && execVal <= endVal) {
                                status = "Fechada";
                            } else {
                                status = "Fechada F.P.";
                            }
                        }
                    } else {
                        // No execution log. Check if Break or Pending.
                        if (CURRENT_DATE_VAL > endVal) {
                            status = "Quebra";
                        } else {
                            status = "Não executado";
                        }
                    }

                    // Format single entry per OM
                    allTasks.push({
                        uniqueId: omId,
                        sector: master.sector,
                        om: omId,
                        asset: master.asset,
                        task: master.task,
                        startDate: startDateStr,
                        endDate: endDateStr,
                        execDate: execDateStr,
                        who: who,
                        status: status
                    });
                });
                return allTasks;
            }, []);

            const filteredData = useMemo(() => {
                return unifiedData.filter(item => {
                    const matchesTab = activeTab === "Visão Geral" || item.sector === activeTab;
                    const matchesSearch = searchTerm === "" || 
                        item.om.toLowerCase().includes(searchTerm.toLowerCase()) || 
                        item.asset.toLowerCase().includes(searchTerm.toLowerCase()) || 
                        item.task.toLowerCase().includes(searchTerm.toLowerCase());
                    return matchesTab && matchesSearch;
                });
            }, [unifiedData, activeTab, searchTerm]);

            const stats = useMemo(() => {
                const counts = {
                    "Fechada": 0,
                    "Fechada F.P.": 0,
                    "Em execução": 0,
                    "Quebra": 0,
                    "Não executado": 0
                };
                
                filteredData.forEach(item => {
                    if (counts[item.status] !== undefined) counts[item.status]++;
                });

                const sectors = ["Linhas", "Metal", "Plástico"];
                const chartData = sectors.map(sec => {
                    const items = unifiedData.filter(d => d.sector === sec);
                    return {
                        name: sec,
                        "Fechada": items.filter(i => i.status === "Fechada").length,
                        "Fechada F.P.": items.filter(i => i.status === "Fechada F.P.").length,
                        "Em execução": items.filter(i => i.status === "Em execução").length,
                        "Quebra": items.filter(i => i.status === "Quebra").length,
                        "Não executado": items.filter(i => i.status === "Não executado").length,
                    };
                });

                return { counts, chartData };
            }, [filteredData, unifiedData]);

            const COLORS = {
                'Fechada': '#10b981', 
                'Fechada F.P.': '#047857', 
                'Em execução': '#f59e0b', 
                'Quebra': '#ef4444', 
                'Não executado': '#94a3b8'
            };

            return (
                <div className="min-h-screen pb-20">
                    <header className="bg-white border-b border-slate-200 sticky top-0 z-30 shadow-sm">
                        <div className="max-w-7xl mx-auto px-4 py-3 md:py-0 md:h-16 flex flex-col md:flex-row items-center justify-between gap-3">
                            <div className="flex items-center gap-3 w-full md:w-auto">
                                <div className="bg-blue-700 p-2 rounded-lg text-white"><Icons.Activity size={20} /></div>
                                <div><h1 className="text-lg md:text-xl font-bold text-slate-900">Monitoramento de Férias</h1><p className="text-xs text-slate-500 hidden md:block">Visão Consolidada ({DATA_PROGRAMADA.length} OMs)</p></div>
                            </div>
                            <div className="flex gap-2 items-center w-full md:w-auto">
                                <div className="relative flex-1 md:w-64">
                                    <span className="absolute left-2.5 top-2.5 text-slate-400"><Icons.Search size={16}/></span>
                                    <input type="text" placeholder="Buscar OM, Ativo..." className="pl-9 pr-4 py-2 bg-slate-100 border-none rounded-lg text-sm focus:ring-2 focus:ring-blue-500 w-full" value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} />
                                </div>
                            </div>
                        </div>
                        <div className="max-w-7xl mx-auto px-4 flex gap-6 overflow-x-auto border-t border-slate-100 no-scrollbar">
                            {["Visão Geral", "Linhas", "Metal", "Plástico"].map(tab => (
                                <button key={tab} onClick={() => setActiveTab(tab)} className={`py-3 text-sm font-bold border-b-2 transition-colors whitespace-nowrap ${activeTab === tab ? 'border-blue-600 text-blue-600' : 'border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300'}`}>{tab}</button>
                            ))}
                        </div>
                    </header>

                    <main className="max-w-7xl mx-auto px-4 py-6 md:py-8 space-y-6">
                        <div className="bg-slate-100 border border-slate-200 rounded-lg p-3 flex gap-3 items-center text-sm text-slate-600">
                            <Icons.FileText size={16} className="flex-shrink-0"/>
                            <span>Análise baseada em Janelas de Execução (Início a Fim). Data Ref: <strong>{CURRENT_DATE_STR}</strong>.</span>
                        </div>

                        <div className="grid grid-cols-2 md:grid-cols-5 gap-2">
                             <div className="bg-white p-3 rounded-lg border border-emerald-100 shadow-sm flex flex-col justify-between border-t-4 border-t-emerald-500">
                                <p className="text-emerald-700 text-[10px] font-bold uppercase mb-1">Fechada</p>
                                <span className="text-2xl font-bold text-emerald-600">{stats.counts['Fechada']}</span>
                            </div>
                            <div className="bg-white p-3 rounded-lg border border-emerald-800 shadow-sm flex flex-col justify-between border-t-4 border-t-emerald-900">
                                <p className="text-emerald-900 text-[10px] font-bold uppercase mb-1">Fechada F.P.</p>
                                <span className="text-2xl font-bold text-emerald-900">{stats.counts['Fechada F.P.']}</span>
                            </div>
                            <div className="bg-white p-3 rounded-lg border border-amber-100 shadow-sm flex flex-col justify-between border-t-4 border-t-amber-500">
                                <p className="text-amber-700 text-[10px] font-bold uppercase mb-1">Em Execução</p>
                                <span className="text-2xl font-bold text-amber-600">{stats.counts['Em execução']}</span>
                            </div>
                            <div className="bg-white p-3 rounded-lg border border-red-100 shadow-sm flex flex-col justify-between border-t-4 border-t-red-500">
                                <p className="text-red-600 text-[10px] font-bold uppercase mb-1">Quebra</p>
                                <span className="text-2xl font-bold text-red-600">{stats.counts['Quebra']}</span>
                            </div>
                            <div className="bg-white p-3 rounded-lg border border-slate-200 shadow-sm flex flex-col justify-between border-t-4 border-t-slate-400">
                                <p className="text-slate-500 text-[10px] font-bold uppercase mb-1">Não Executado</p>
                                <span className="text-2xl font-bold text-slate-600">{stats.counts['Não executado']}</span>
                            </div>
                        </div>

                        <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                            <div className="bg-white p-5 rounded-xl border border-slate-200 shadow-sm lg:col-span-2">
                                <h3 className="font-bold text-slate-800 mb-4">Status por Área (Qtd. OMs)</h3>
                                <div className="h-64 w-full">
                                    <ResponsiveContainer width="100%" height="100%">
                                        <BarChart data={stats.chartData} layout="vertical">
                                            <CartesianGrid strokeDasharray="3 3" horizontal={true} stroke="#e2e8f0" />
                                            <XAxis type="number" hide />
                                            <YAxis dataKey="name" type="category" width={70} tick={{fontSize: 11, fontWeight: 'bold'}} />
                                            <RechartsTooltip cursor={{fill: 'transparent'}} contentStyle={{borderRadius: '8px', border: 'none', boxShadow: '0 4px 6px -1px rgba(0,0,0,0.1)'}} />
                                            <Legend iconSize={10} wrapperStyle={{fontSize: '12px'}}/>
                                            <Bar dataKey="Fechada" stackId="a" fill={COLORS['Fechada']} barSize={20} />
                                            <Bar dataKey="Fechada F.P." stackId="a" fill={COLORS['Fechada F.P.']} barSize={20} />
                                            <Bar dataKey="Em execução" stackId="a" fill={COLORS['Em execução']} barSize={20} />
                                            <Bar dataKey="Quebra" stackId="a" fill={COLORS['Quebra']} barSize={20} />
                                            <Bar dataKey="Não executado" stackId="a" fill={COLORS['Não executado']} radius={[0, 4, 4, 0]} barSize={20} />
                                        </BarChart>
                                    </ResponsiveContainer>
                                </div>
                            </div>
                            <div className="bg-white p-5 rounded-xl border border-slate-200 shadow-sm">
                                <h3 className="font-bold text-slate-800 mb-4">Total Geral</h3>
                                <div className="h-64 w-full flex flex-col items-center justify-center">
                                    <ResponsiveContainer width="100%" height="100%">
                                        <PieChart>
                                            <Pie 
                                                data={[
                                                    { name: 'Fechada', value: stats.counts['Fechada'] },
                                                    { name: 'Fechada F.P.', value: stats.counts['Fechada F.P.'] },
                                                    { name: 'Em execução', value: stats.counts['Em execução'] },
                                                    { name: 'Quebra', value: stats.counts['Quebra'] },
                                                    { name: 'Não executado', value: stats.counts['Não executado'] },
                                                ]} 
                                                innerRadius={60} 
                                                outerRadius={80} 
                                                paddingAngle={2} 
                                                dataKey="value"
                                                label={({ percent }) => percent > 0 ? `${(percent * 100).toFixed(0)}%` : ''}
                                            >
                                                <Cell fill={COLORS['Fechada']} />
                                                <Cell fill={COLORS['Fechada F.P.']} />
                                                <Cell fill={COLORS['Em execução']} />
                                                <Cell fill={COLORS['Quebra']} />
                                                <Cell fill={COLORS['Não executado']} />
                                            </Pie>
                                            <RechartsTooltip />
                                            <Legend verticalAlign="bottom" height={36} iconSize={8} wrapperStyle={{fontSize: '10px'}}/>
                                        </PieChart>
                                    </ResponsiveContainer>
                                </div>
                            </div>
                        </div>

                         <div className="space-y-4">
                            <div className="flex justify-between items-center px-2">
                                <h3 className="font-bold text-slate-700 flex items-center gap-2"><Icons.Check size={18} className="text-slate-400" /> Detalhamento ({stats.counts['Fechada'] + stats.counts['Fechada F.P.'] + stats.counts['Em execução'] + stats.counts['Quebra'] + stats.counts['Não executado']} OMs)</h3>
                            </div>

                            <div className="md:hidden space-y-3">
                                {filteredData.map((task, idx) => (
                                    <div key={idx} className="bg-white p-4 rounded-xl border border-slate-200 shadow-sm">
                                        <div className="flex justify-between items-start mb-2">
                                            <span className={`text-[10px] font-bold px-2 py-0.5 rounded uppercase ${task.sector === 'Linhas' ? 'bg-cyan-100 text-cyan-800' : task.sector === 'Metal' ? 'bg-orange-100 text-orange-800' : 'bg-blue-100 text-blue-800'}`}>{task.sector}</span>
                                            <span className={`inline-flex items-center gap-1 px-2 py-0.5 rounded text-[10px] font-bold border ${
                                                task.status === 'Fechada' ? 'bg-emerald-100 text-emerald-700 border-emerald-200' :
                                                task.status === 'Fechada F.P.' ? 'bg-emerald-200 text-emerald-900 border-emerald-300' :
                                                task.status === 'Em execução' ? 'bg-amber-100 text-amber-700 border-amber-200' :
                                                task.status === 'Quebra' ? 'bg-red-50 text-red-600 border-red-200' :
                                                'bg-slate-100 text-slate-500 border-slate-200'
                                            }`}>
                                                {task.status}
                                            </span>
                                        </div>
                                        <div className="flex justify-between items-center mb-1">
                                            <span className="font-mono font-bold text-slate-500 text-xs">OM {task.om}</span>
                                        </div>
                                        <h4 className="font-bold text-slate-800 text-sm mb-1">{task.asset}</h4>
                                        <p className="text-xs text-slate-500 mb-3">{task.task}</p>
                                        
                                        <div className="grid grid-cols-3 gap-2 text-xs border-t border-slate-100 pt-2">
                                            <div>
                                                <span className="text-slate-400 block text-[9px] uppercase">Início Plan.</span>
                                                <span className="font-mono font-bold text-blue-600">{task.startDate}</span>
                                            </div>
                                            <div>
                                                <span className="text-slate-400 block text-[9px] uppercase">Fim Plan.</span>
                                                <span className="font-mono font-bold text-blue-600">{task.endDate}</span>
                                            </div>
                                            <div>
                                                <span className="text-slate-400 block text-[9px] uppercase">Execução</span>
                                                <span className={`font-mono font-bold ${task.status.includes('Fechada') ? 'text-emerald-600' : 'text-slate-400'}`}>{task.execDate}</span>
                                            </div>
                                        </div>
                                        {task.who !== '-' && <div className="mt-2 text-[10px] text-slate-400 italic pt-1">Exec: {task.who}</div>}
                                    </div>
                                ))}
                            </div>

                            <div className="hidden md:block bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden">
                                <div className="overflow-x-auto max-h-[600px] custom-scrollbar">
                                    <table className="w-full text-left border-collapse">
                                        <thead className="bg-slate-50 sticky top-0 z-10 shadow-sm">
                                            <tr className="text-xs font-bold text-slate-500 uppercase">
                                                <th className="p-3 border-b border-slate-200 w-20">Setor</th>
                                                <th className="p-3 border-b border-slate-200 w-24">OM</th>
                                                <th className="p-3 border-b border-slate-200">Descrição / Ativo</th>
                                                <th className="p-3 border-b border-slate-200 w-24 text-center">Início Plan.</th>
                                                <th className="p-3 border-b border-slate-200 w-24 text-center">Fim Plan.</th>
                                                <th className="p-3 border-b border-slate-200 w-24 text-center">Execução</th>
                                                <th className="p-3 border-b border-slate-200 w-36 text-center">Status</th>
                                            </tr>
                                        </thead>
                                        <tbody className="text-sm">
                                            {filteredData.map((task, idx) => (
                                                <tr key={idx} className="hover:bg-slate-50 transition-colors border-b border-slate-100 last:border-0">
                                                    <td className="p-3"><span className={`text-[10px] font-bold px-2 py-0.5 rounded uppercase ${task.sector === 'Linhas' ? 'bg-cyan-100 text-cyan-800' : task.sector === 'Metal' ? 'bg-orange-100 text-orange-800' : 'bg-blue-100 text-blue-800'}`}>{task.sector}</span></td>
                                                    <td className="p-3 font-mono text-xs font-bold text-slate-600">{task.om}</td>
                                                    <td className="p-3">
                                                        <div className="font-medium text-slate-800 text-xs">{task.asset}</div>
                                                        <div className="text-[10px] text-slate-500">{task.task}</div>
                                                        {task.who !== '-' && <div className="text-[9px] text-slate-400 italic mt-0.5">Exec: {task.who}</div>}
                                                    </td>
                                                    <td className="p-3 text-center font-mono text-xs font-bold text-blue-600">{task.startDate}</td>
                                                    <td className="p-3 text-center font-mono text-xs font-bold text-blue-600">{task.endDate}</td>
                                                    <td className="p-3 text-center font-mono text-xs font-bold text-slate-700">{task.execDate}</td>
                                                    <td className="p-3 text-center">
                                                        <span className={`inline-flex items-center gap-1 px-2 py-1 rounded-full text-[10px] font-bold w-full justify-center border ${
                                                            task.status === 'Fechada' ? 'bg-emerald-100 text-emerald-700 border-emerald-200' :
                                                            task.status === 'Fechada F.P.' ? 'bg-emerald-200 text-emerald-900 border-emerald-300' :
                                                            task.status === 'Em execução' ? 'bg-amber-100 text-amber-700 border-amber-200' :
                                                            task.status === 'Quebra' ? 'bg-red-50 text-red-600 border-red-200' :
                                                            'bg-slate-100 text-slate-500 border-slate-200'
                                                        }`}>
                                                            {task.status === 'Fechada' && <Icons.Check size={10}/>}
                                                            {task.status === 'Fechada F.P.' && <Icons.Check size={10}/>}
                                                            {task.status === 'Em execução' && <Icons.PlayCircle size={10}/>}
                                                            {task.status === 'Quebra' && <Icons.Alert size={10}/>}
                                                            {task.status === 'Não executado' && <Icons.Clock size={10}/>}
                                                            {task.status}
                                                        </span>
                                                    </td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                        </div>
                    </main>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<UnifiedDashboard />);
    </script>
</body>
</html>